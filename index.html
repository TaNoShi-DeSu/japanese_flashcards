<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Japanese Flashcards</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 700px;
      margin: 20px auto;
      background: #f9f9f9;
      padding: 20px;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    .category {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    .category h2 {
      background: #4a90e2;
      color: white;
      padding: 12px 16px;
      margin: 0;
      font-size: 1.2em;
      cursor: pointer;
      user-select: none;
      border-radius: 8px 8px 0 0;
    }
    .content {
      display: none;
      padding: 15px;
    }
    .category.expanded .content {
      display: block;
    }
    ul {
      list-style: none;
      margin: 0;
      padding: 0;
    }
    li {
      border-bottom: 1px solid #eee;
      padding: 12px 0;
    }
    .jp-sentence {
      font-weight: bold;
      font-size: 1.1em;
      margin-bottom: 8px;
      color: #333;
    }
    .romaji, .zh {
      font-size: 0.95em;
      margin-bottom: 4px;
      color: #555;
    }
    button.play-btn {
      background-color: #4a90e2;
      color: #fff;
      border: none;
      padding: 6px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      font-size: 0.9em;
      margin-top: 6px;
    }
    button.play-btn:hover {
      background-color: #357abd;
    }
  </style>
</head>
<body>
  <h1>Japanese Flashcards</h1>
  <div id="categories-container"></div>

  <script>
    let voices = [];

    const data = [
      {
        category: "打招呼",
        sentences: [
          {
            jp: "こんにちは。",
            kanji: "今日は。",
            zh: "你好／午安。",
            romaji: "Konnichiwa."
          },
          {
            jp: "おはようございます。",
            kanji: "お早う御座います。",
            zh: "早安。",
            romaji: "Ohayou gozaimasu."
          }
        ]
      },
      {
        category: "禮貌用語",
        sentences: [
          {
            jp: "ありがとうございます。",
            kanji: "有り難う御座います。",
            zh: "謝謝您。",
            romaji: "Arigatou gozaimasu."
          },
          {
            jp: "すみません。",
            kanji: "済みません。",
            zh: "不好意思／對不起。",
            romaji: "Sumimasen."
          }
        ]
      },
      {
        category: "問路 / 方向",
        sentences: [
          {
            jp: "駅はどこですか？",
            kanji: "駅は何処ですか？",
            zh: "車站在哪裡？",
            romaji: "Eki wa doko desu ka?"
          },
          {
            jp: "右に曲がってください。",
            kanji: "右に曲がって下さい。",
            zh: "請往右轉。",
            romaji: "Migi ni magatte kudasai."
          }
        ]
      },
      {
        category: "餐廳 / 飲食",
        sentences: [
          {
            jp: "メニューをください。",
            kanji: "メニューを下さい。",
            zh: "請給我菜單。",
            romaji: "Menyuu o kudasai."
          }
        ]
      },
      {
        category: "購物 / 金錢",
        sentences: [
          {
            jp: "いくらですか？",
            kanji: "幾らですか？",
            zh: "多少錢？",
            romaji: "Ikura desu ka?"
          }
        ]
      },
      {
        category: "交通 / 旅行",
        sentences: [
          {
            jp: "東京へ行きたいです。",
            kanji: "東京へ行きたいです。",
            zh: "我想去東京。",
            romaji: "Tokyo e ikitai desu."
          }
        ]
      },
      {
        category: "語言溝通",
        sentences: [
          {
            jp: "英語が話せますか？",
            kanji: "英語が話せますか？",
            zh: "你會講英文嗎？",
            romaji: "Eigo ga hanasemasu ka?"
          }
        ]
      }
    ];

    function loadVoices() {
      voices = window.speechSynthesis.getVoices();
    }

    if (typeof speechSynthesis !== "undefined") {
      loadVoices();
      speechSynthesis.onvoiceschanged = loadVoices;
    }

    const container = document.getElementById("categories-container");

    data.forEach(cat => {
      const div = document.createElement("div");
      div.className = "category";

      const h2 = document.createElement("h2");
      h2.textContent = cat.category;
      div.appendChild(h2);

      const contentDiv = document.createElement("div");
      contentDiv.className = "content";

      const ul = document.createElement("ul");

      cat.sentences.forEach(item => {
        const li = document.createElement("li");

        const jpSpan = document.createElement("div");
        jpSpan.className = "jp-sentence";
        jpSpan.textContent = item.kanji
          ? `${item.jp} / ${item.kanji}`
          : item.jp;

        // 產生「空格版」羅馬拼音
        const romajiWithSpaces = item.romaji
          .split("")
          .map(char => char === " " ? " " : char)
          .join(" ");

        const romajiDiv = document.createElement("div");
        romajiDiv.className = "romaji";
        romajiDiv.textContent = `羅馬拼音：${romajiWithSpaces}`;

        const zhDiv = document.createElement("div");
        zhDiv.className = "zh";
        zhDiv.textContent = `繁體中文：${item.zh}`;

        const btn = document.createElement("button");
        btn.className = "play-btn";
        btn.textContent = "播放";
        btn.onclick = () => playJapanese(item.jp);

        li.appendChild(jpSpan);
        li.appendChild(romajiDiv);
        li.appendChild(zhDiv);
        li.appendChild(btn);
        ul.appendChild(li);
      });

      contentDiv.appendChild(ul);
      div.appendChild(contentDiv);
      container.appendChild(div);
    });

    document.addEventListener("click", e => {
      if (e.target.tagName === "H2") {
        e.target.parentElement.classList.toggle("expanded");
      }
    });

    function playJapanese(text) {
      if (!("speechSynthesis" in window)) {
        alert("您的瀏覽器不支援語音。");
        return;
      }
      const utter = new SpeechSynthesisUtterance(text);
      const jaVoices = voices.filter(v => v.lang.includes("ja"));
      if (jaVoices.length > 0) {
        utter.voice = jaVoices[0];
      }
      utter.rate = 0.5;
      speechSynthesis.speak(utter);
    }
  </script>
</body>
</html>
